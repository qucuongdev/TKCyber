---
title: 'Tri·ªÉn khai Wazuh - SIEM m√£ ngu·ªìn m·ªü cho doanh nghi·ªáp'
excerpt: 'H∆∞·ªõng d·∫´n chi ti·∫øt c√†i ƒë·∫∑t v√† c·∫•u h√¨nh Wazuh ƒë·ªÉ ph√°t hi·ªán m·ªëi ƒëe d·ªça, gi√°m s√°t t√≠nh to√†n v·∫πn h·ªá th·ªëng v√† ·ª©ng ph√≥ s·ª± c·ªë b·∫£o m·∫≠t.'
category: 'SOC'
date: '2023-10-24'
readTime: '8 ph√∫t ƒë·ªçc'
tags: ['Wazuh', 'SIEM', 'Open Source', 'SOC']
author: 'TKCyber Team'
icon: 'üìä'
---

# Tri·ªÉn khai Wazuh - SIEM m√£ ngu·ªìn m·ªü

## Gi·ªõi thi·ªáu

**SIEM (Security Information and Event Management)** l√† n·ªÅn t·∫£ng c·ªët l√µi trong b·∫•t k·ª≥ Security Operations Center (SOC) n√†o. Trong b√†i vi·∫øt n√†y, ch√∫ng ta s·∫Ω t√¨m hi·ªÉu c√°ch tri·ªÉn khai **Wazuh** - m·ªôt gi·∫£i ph√°p SIEM m√£ ngu·ªìn m·ªü m·∫°nh m·∫Ω, ho√†n to√†n mi·ªÖn ph√≠ v√† ƒë∆∞·ª£c c·ªông ƒë·ªìng tin d√πng.

## Wazuh l√† g√¨?

Wazuh l√† n·ªÅn t·∫£ng b·∫£o m·∫≠t m√£ ngu·ªìn m·ªü cung c·∫•p ƒë·∫ßy ƒë·ªß c√°c t√≠nh nƒÉng:

- **Intrusion Detection (IDS)** - Ph√°t hi·ªán x√¢m nh·∫≠p v√† t·∫•n c√¥ng
- **File Integrity Monitoring (FIM)** - Gi√°m s√°t thay ƒë·ªïi file/registry
- **Log Analysis** - Ph√¢n t√≠ch log t·∫≠p trung t·ª´ nhi·ªÅu ngu·ªìn
- **Vulnerability Detection** - Qu√©t v√† ph√°t hi·ªán l·ªó h·ªïng b·∫£o m·∫≠t
- **Compliance Assessment** - ƒê√°nh gi√° tu√¢n th·ªß (PCI DSS, GDPR, HIPAA)
- **Incident Response** - H·ªó tr·ª£ ·ª©ng ph√≥ s·ª± c·ªë

## Ki·∫øn tr√∫c Wazuh

Wazuh s·ª≠ d·ª•ng ki·∫øn tr√∫c **agent-server**:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Wazuh Manager  ‚îÇ ‚óÑ‚îÄ‚îÄ Server trung t√¢m
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê
‚îÇAgent ‚îÇ  ‚îÇAgent ‚îÇ ‚óÑ‚îÄ‚îÄ C√°c m√°y ƒë∆∞·ª£c gi√°m s√°t
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### C√°c th√†nh ph·∫ßn ch√≠nh:

1. **Wazuh Manager** - Server trung t√¢m nh·∫≠n d·ªØ li·ªáu, ph√¢n t√≠ch v√† t·∫°o c·∫£nh b√°o
2. **Wazuh Agents** - C√†i tr√™n c√°c m√°y c·∫ßn gi√°m s√°t, thu th·∫≠p logs/events
3. **Elastic Stack** - L∆∞u tr·ªØ, ƒë√°nh index v√† visualize d·ªØ li·ªáu
4. **Wazuh Dashboard** - Giao di·ªán web qu·∫£n l√Ω v√† gi√°m s√°t

## H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t

### B∆∞·ªõc 1: C√†i ƒë·∫∑t Wazuh Manager

Tr√™n m√°y ch·ªß Ubuntu/Debian:

```bash
# Download script c√†i ƒë·∫∑t
curl -sO https://packages.wazuh.com/4.7/wazuh-install.sh

# Ch·∫°y installer (all-in-one)
bash ./wazuh-install.sh -a
```

Script s·∫Ω t·ª± ƒë·ªông c√†i:
- Wazuh Manager
- Wazuh Indexer (Elasticsearch)
- Wazuh Dashboard (Kibana)

### B∆∞·ªõc 2: C√†i ƒë·∫∑t Agent

**Tr√™n Windows:**

```powershell
# Download installer
Invoke-WebRequest -Uri https://packages.wazuh.com/4.x/windows/wazuh-agent-4.7.0-1.msi -OutFile wazuh-agent.msi

# C√†i ƒë·∫∑t v√† k·∫øt n·ªëi v·ªõi Manager
msiexec.exe /i wazuh-agent.msi /q WAZUH_MANAGER='IP_CUA_MANAGER'
```

**Tr√™n Linux:**

```bash
# Ubuntu/Debian
wget https://packages.wazuh.com/4.x/apt/pool/main/w/wazuh-agent/wazuh-agent_4.7.0-1_amd64.deb
dpkg -i wazuh-agent_4.7.0-1_amd64.deb

# C·∫•u h√¨nh Manager IP
echo "WAZUH_MANAGER='IP_CUA_MANAGER'" >> /var/ossec/etc/ossec.conf

# Kh·ªüi ƒë·ªông agent
systemctl start wazuh-agent
```

### B∆∞·ªõc 3: C·∫•u h√¨nh Rules

T·∫°o custom rules ƒë·ªÉ ph√°t hi·ªán c√°c m·ªëi ƒëe d·ªça c·ª• th·ªÉ:

```xml
<!-- File: /var/ossec/etc/rules/local_rules.xml -->
<group name="custom_rules">
  <!-- Ph√°t hi·ªán brute force SSH -->
  <rule id="100010" level="10">
    <if_sid>5715</if_sid>
    <match>Failed password</match>
    <description>Ph√°t hi·ªán t·∫•n c√¥ng brute force SSH</description>
  </rule>
</group>
```

## Use Cases th·ª±c t·∫ø

### 1. Ph√°t hi·ªán t·∫•n c√¥ng Brute Force

Wazuh t·ª± ƒë·ªông ph√°t hi·ªán v√† c·∫£nh b√°o khi c√≥:

- Nhi·ªÅu l·∫ßn ƒëƒÉng nh·∫≠p th·∫•t b·∫°i li√™n ti·∫øp
- T·∫•n c√¥ng dictionary/brute force
- T·ª± ƒë·ªông block IP k·∫ª t·∫•n c√¥ng

**C·∫•u h√¨nh:**

```xml
<ossec_config>
  <active-response>
    <!-- Block IP sau 5 l·∫ßn ƒëƒÉng nh·∫≠p th·∫•t b·∫°i -->
    <command>firewall-drop</command>
    <location>local</location>
    <rules_id>100010</rules_id>
    <timeout>600</timeout>
  </active-response>
</ossec_config>
```

### 2. Gi√°m s√°t File Integrity (FIM)

Theo d√µi m·ªçi thay ƒë·ªïi tr√™n file/folder quan tr·ªçng:

```xml
<syscheck>
  <!-- Gi√°m s√°t th∆∞ m·ª•c h·ªá th·ªëng -->
  <directories check_all="yes">/etc,/usr/bin,/usr/sbin</directories>
  
  <!-- Gi√°m s√°t real-time cho web -->
  <directories check_all="yes" realtime="yes">/var/www</directories>
  
  <!-- Gi√°m s√°t Windows Registry -->
  <windows_registry>HKEY_LOCAL_MACHINE\Software</windows_registry>
</syscheck>
```

**Khi c√≥ file thay ƒë·ªïi:**
- Wazuh ghi l·∫°i: ai, khi n√†o, thay ƒë·ªïi g√¨
- G·ª≠i c·∫£nh b√°o real-time
- L∆∞u v√†o Elastic ƒë·ªÉ ph√¢n t√≠ch

### 3. Compliance Monitoring

Wazuh t·ª± ƒë·ªông ki·ªÉm tra tu√¢n th·ªß cho:

- **PCI DSS** - B·∫£o m·∫≠t th·∫ª thanh to√°n
- **GDPR** - B·∫£o v·ªá d·ªØ li·ªáu c√° nh√¢n
- **HIPAA** - B·∫£o m·∫≠t y t·∫ø
- **NIST 800-53** - Chu·∫©n b·∫£o m·∫≠t M·ªπ

Dashboard s·∫Ω hi·ªÉn th·ªã:
- M·ª©c ƒë·ªô tu√¢n th·ªß (%)
- C√°c y√™u c·∫ßu ch∆∞a ƒë√°p ·ª©ng
- H∆∞·ªõng d·∫´n kh·∫Øc ph·ª•c

## Best Practices

### 1. Tinh ch·ªânh Rules

```bash
# Gi·∫£m false positives
- Review logs h√†ng ng√†y
- T·∫°o whitelist cho ho·∫°t ƒë·ªông h·ª£p l·ªá
- ƒêi·ªÅu ch·ªânh severity levels

# TƒÉng detection rate
- Th√™m custom rules cho m√¥i tr∆∞·ªùng c·ªßa b·∫°n
- T√≠ch h·ª£p Threat Intelligence feeds
- Enable behavioural analysis
```

### 2. Qu·∫£n l√Ω Agents

```bash
# Ki·ªÉm tra agent status
/var/ossec/bin/agent_control -l

# Restart agent
systemctl restart wazuh-agent

# View agent logs
tail -f /var/ossec/logs/ossec.log
```

### 3. Log Retention

C√¢n b·∫±ng gi·ªØa l∆∞u tr·ªØ v√† compliance:

```
- Short-term (hot): 7-30 ng√†y tr√™n SSD
- Medium-term (warm): 30-90 ng√†y tr√™n HDD
- Long-term (cold): 90-365 ng√†y tr√™n archive
```

### 4. Alert Management

```yaml
Priority levels:
  - CRITICAL (12-15): X·ª≠ l√Ω ngay l·∫≠p t·ª©c
  - HIGH (9-11): X·ª≠ l√Ω trong 1 gi·ªù
  - MEDIUM (6-8): X·ª≠ l√Ω trong 24h
  - LOW (1-5): Review ƒë·ªãnh k·ª≥
```

## Performance Tuning

ƒê·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t:

```xml
<ossec_config>
  <global>
    <!-- TƒÉng s·ªë worker threads -->
    <analysisd>
      <worker_threads>4</worker_threads>
    </analysisd>
    
    <!-- Enable JSON output -->
    <jsonout_output>yes</jsonout_output>
  </global>
</ossec_config>
```

**Monitoring:**
- CPU usage < 70%
- Memory usage < 80%
- Disk I/O stable
- Network latency < 100ms

## T√≠ch h·ª£p v·ªõi c√°c c√¥ng c·ª• kh√°c

Wazuh c√≥ th·ªÉ t√≠ch h·ª£p v·ªõi:

### SOAR Platforms
- **TheHive** - Case management
- **Shuffle** - Automation workflows
- **Cortex** - Threat intelligence

### Threat Intelligence
- **MISP** - Sharing IOCs
- **VirusTotal** - Malware detection
- **AbuseIPDB** - IP reputation

### Communication
- **Slack** - Real-time alerts
- **Email** - Alert notifications
- **PagerDuty** - On-call management

## Troubleshooting

### Agent kh√¥ng k·∫øt n·ªëi ƒë∆∞·ª£c?

```bash
# Check firewall
ufw allow 1514/tcp
ufw allow 1515/tcp

# Check agent status
systemctl status wazuh-agent

# View logs
tail -f /var/ossec/logs/ossec.log
```

### Dashboard kh√¥ng load?

```bash
# Restart services
systemctl restart wazuh-dashboard

# Check Elasticsearch
curl -X GET "localhost:9200/_cluster/health"
```

## K·∫øt lu·∫≠n

Wazuh l√† gi·∫£i ph√°p SIEM m·∫°nh m·∫Ω, ho√†n to√†n mi·ªÖn ph√≠ v·ªõi ƒë·∫ßy ƒë·ªß t√≠nh nƒÉng:

‚úÖ **Ph√°t hi·ªán threats real-time**  
‚úÖ **File integrity monitoring**  
‚úÖ **Vulnerability scanning**  
‚úÖ **Compliance reporting**  
‚úÖ **D·ªÖ d√†ng scale v√† m·ªü r·ªông**  
‚úÖ **C·ªông ƒë·ªìng l·ªõn, t√†i li·ªáu phong ph√∫**  

Wazuh l√† l·ª±a ch·ªçn tuy·ªát v·ªùi cho:
- Doanh nghi·ªáp v·ª´a v√† nh·ªè
- T·ªï ch·ª©c mu·ªën x√¢y d·ª±ng SOC
- M√¥i tr∆∞·ªùng c·∫ßn compliance
- Budget h·∫°n ch·∫ø

## T√†i li·ªáu tham kh·∫£o

- [Wazuh Documentation](https://documentation.wazuh.com)
- [Wazuh GitHub](https://github.com/wazuh/wazuh)
- [Community Forum](https://wazuh.com/community/)
- [Ruleset](https://documentation.wazuh.com/current/user-manual/ruleset/)

---

**Tags:** #SIEM #Wazuh #SOC #OpenSource #Monitoring

